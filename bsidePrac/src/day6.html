<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<script>
    //꼬리물기 최적화를 제어문으로 바꿔볼 것!

    // const arr = [1,[2,[3,[4,'가',5],6],7],8,[9,[10]],'나']; // sum = 55
    const arr = [1, [2, 3], 4]; // sum = 6
    // const arr = [1, 2, 3]; // sum = 6
    // const fStack = [[arr, 0]];
    const fStack = [{arr, idx: 0}];
    const subStack = [];
    let acc = 0;

    while (fStack.length > 0) {

        let {arr, idx} = fStack.pop();

        if (arr.length == idx) {
            // let {arr:arr2, idx:idx2} = subStack.pop();
            let a = subStack.pop();
            arr = a.arr;
            idx = a.idx;
            // arr=arr2;
            // idx=idx2;
        } else {
            //배열일 때
            if (Array.isArray(arr[idx])) {
                subStack.push({arr: arr, idx: idx + 1}); //끝내고 돌아갈 곳
                fStack.push({arr: arr[idx], idx: 0});
            }

            //숫자일 때
            else if (!isNaN(arr[idx])) {
                acc += arr[idx];
                fStack.push({arr, idx: idx + 1});
            }
        }
    }
    console.log(acc);


    // const _sum = function (arr, i, acc, stack) {
    //    //종료되는 시점 -> 1.arr을 전부 돌았는가?  2.stack을 다비웠는가?
    //
    //     if (i === arr.length) {
    //         if (stack.length !== 0) {
    //             const stackArr = stack.pop();
    //             return _sum(stackArr[0], stackArr[1], acc, stack);
    //         } else {
    //             return acc;
    //         }
    //     } //end if
    //
    //     //배열이라면
    //     if (Array.isArray(arr[i])) {
    //         //stack에는 [돌아가야하는 배열(arr), 계산하고 돌아갈 위치(i+1)]
    //         stack.push([arr, i + 1]);
    //         return _sum(arr[i], 0, acc, stack);
    //     }
    //     //숫자라면
    //     else if (!isNaN(arr[i])) {
    //         return _sum(arr, i + 1, acc + arr[i], stack);
    //     }
    //     else {
    //         //숫자나 배열도 아니라면, 0을 더해주고 pass
    //         return _sum(arr, i + 1, acc + 0, stack);
    //     }
    // }
    //
    // const sum = function(arr){
    //     return _sum(arr, 0, 0, []);
    // }


</script>

</body>
</html>